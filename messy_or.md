# Перепутанные ИЛИ
***Задача на нахождение алгоритма***

Пусть $n=2^k, k > 0$. Рассмотрим матрицу $M_{n\times n}$, где строки и столбцы пронумеруем двоичным представлением векторов в $\mathbb{B}^k$ (векторы в $k$-мерном булевом пространстве). Определим элементы $M$ так: $m_{v, u} = v_1u_1\lor v_2u_2 \ldots \lor v_ku_k$.

Дана матрица $T_{n \times n}$ из нулей и единиц. Определите, существуют ли перестановки $p, q \in S_n$ для строк и столбцов, которые приведут матрицу $T$ к виду $M$. 

## Решение
Перестановка строк матрицы является перестановкой вершин булева куба. 
Заметим, что должен существовать нулевой столбец, а также $k$ сбалансированных столбцов (количество нулей и единиц совпадают), эти столбцы - кандидаты на "запутанные" тривиальные дизъюнкции, то есть проекции на оси координат ($\varphi_i(\vec{x}) = x_i$).

**Утверждение 1.**
Пусть $f_1, \ldots, f_k$ - сбалансированные булевы функции, совпадающие в половине единиц. Тогда существует перестановка вершин булева куба $\mathbb{B}^k$, переводящая $f_1, \ldots, f_k$ в проекции $f'_1 = x_1, \ldots, f'_k=x_k$.

**Доказательство**.
Такая перестановка дается следующей биекцией $F:\mathbb{B}^k \to \mathbb{B}^k$. 

$$F(v) = (f_1(v), f_2(v), \ldots, f_n(v)).$$

Инъективность следует из того, что добавление функции $f_i$ к системе из других функций этого множества уменьшает в 2 количество общих единиц.
$\square$

Убедившись в наличии нулевого столбца и найдя систему функций $f_1, \ldots, f_k$, осталось проверить что все столбцы $T$ получаются дизъюнкциями $f$. Для этого проверим для всех $i \in [1, k]$ и $j \in [1, n]$, что 
$f_i \lor T_j \in T$, где $T_j$ - $j$-й столбец $T$. 